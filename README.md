# Отчёт по симуляции Монте-Карло для оценки влияния нового алгоритма рекомендаций
## Введение

Наша команда провела встречу с коллегами из ML-отдела, в ходе которой обсуждался новый алгоритм, предназначенный для рекомендации интересных постов пользователям. Цель алгоритма — увеличение вовлечённости пользователей, измеряемой количеством просмотров и лайков. На основе обсуждений были определены следующие характеристики алгоритма:
- Алгоритм увеличивает количество просмотров на 1–2 для каждого пользователя.
- Вероятность срабатывания алгоритма составляет 90%.
- Алгоритм не применяется к пользователям с количеством просмотров менее 30.

Мы предположили, что увеличение числа просмотров может привести к росту среднего количества лайков на пользователя. Для оценки возможности обнаружения статистически значимых различий в среднем количестве лайков была проведена симуляция Монте-Карло.

## Цель 

Оценить, сможем ли мы выявить различия в среднем количестве лайков на пользователя при внедрении нового алгоритма рекомендаций.

## Методология 

Перед A/B тестированием проводят так назваемые A/A тест, чтобы выяснить на какую мощность можно расчитывать для
заданных временных рамок и кол-ве пользователей. Оценить мощность можно из данных A/A теста путем модифицирования
метрик, который предполагаемо изменяет алгоритм. В данном случае алгоритм увеличиваем просмотры. Из этого вытекают основные шаги для решение задачи: 

- Распределения, из которых мы будем симулировать просмотры и пользовательские CTR, мы построим на основе периода АА-теста.
- Разбиваем пользователей на две группы в соотношении 50/50
- Кол-во пользователей берем таким как будто A/A тест проводился 2 недели.
- Модифицированные просмотры формируются следующим образом. Сначала биномальным распределением иммитируется добавление 1 или 2 просмотров, причем с события предполагаются равновероятными p=0.5. ```np.binomial(n=1, p=0.5, size=размер_выборки)``` равновероятно принимает значение 0 или 1, при добавлении 1 получаем равновероятное добавление 1 или 2 просмотров. Далее по правилу перемножения вероятности иммитируется, что алгоритм сработает в 90% случаев. А именно домножается на соответвуещее биномиальное распределение с исходами сработал 1 и не сработал 0. Далее все умножается на глобальное условие, что алгоритм вообще не будет работать если в группе B будет меньше 30 просмотров.
- Кол-во симуляций 20000
- Лайки мы будем сравнивать t-тестом с поправкой Уэлча на неравные дисперсии (```equal_var=False```). Уровень значимости поставим 0.05.
- Расчитаваем мощность теста из симулированных выборок.

## Вывод 

Мощность для алгоритма, который не срабатывает на пользователях у которых 30 и меньше просмотров: 64.91%
Aлгоритм не дает приемлемую мощность для таких размеров выборок и сроках эксперимента(мощность должна быть больше 80%).




